# План автоматизации тестирования сценария покупки тура через комплексный веб-сервис, взаимодействующего с СУБД и API Банка.

## 1. Перечень автоматизируемых сценариев
***ВАЖНО** Перед началом тестирования сценариев, необходимо правильно запустить SUT. Вся информация о последовательности действий для успешного запуска приведена в файле README.md*

**Сценарий 1:**
№пп | шаги  |ожидаемый результат
--- | --- | ---
1.| Перейти на [веб-сервис "Путешествие дня"](http://localhost:8080/)| Сайт открывается.
2.|Кликнуть по книпке с текстом "Купить"| Окрывается форма "Оплата по карте" с полями для заполнения данных карты.
3.|В открывшейся форме, щелкнуть на поле "Номер карты" (элемент с тегом *input__top="Номер карты"*)|Поле активно для ввода номера карты. Бледным текстом отображается формат ввода номера карты "ХХХХ ХХХХ ХХХХ ХХХХ"
*Сценарии тестирования поля "Номер карты"*|
*Позитивный сценарий*|
3.1|Заполнить поле валидным номером карты, например "4444 4444 4444 4441" и статусом APPROVED|При нажатие на кнопку с текстом "Продолжить" (при заполненных всех других полей валидными данными), выполняется сценарий 3 (см.ниже).
3.2|Заполнить поле валидным номером карты, "4444 4444 4444 4442" и статусом DECLINED|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 3 (см.ниже).
*Негативный сценарий*|
3.3|Оставить поле пустым|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Поле не должно быть пустым".
3.4|Заполнить поле цифрами в количестве меньше 16|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Неверный формат".
3.5|Заполнить поле "0000 0000 0000 0000"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Неверный формат".
3.6|Заполнить поле не цифровыми значениями(буквы, спец символы)| Система не допускает ввод не цифровых символов в поле.
3.7|Заполнить поле невалидным номером карты, например "4444 4444 4444 4444"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), происходит запрос в банковский сервис и при получении от него ответа, система выдает сообщение об ошибки "Банк отказал в проведении операции". Запись в БД не происходит.
4.|В открывшейся форме, щелкнуть на поле "Месяц" (элемент с тегом *input__top="Месяц"*)|Поле активно для ввода номера месяца. Бледный текстом номер текущего месяца в формате "ММ".
*Сценарий тестирования поля "Месяц"*|
*Позитивный сценарий*|
4.1|Заполнить поле валидными значениями в формате "ММ", например "01" или "12"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 3 (см.ниже).
4.2|Заполнить поле валидными значениями в формате "М", например "1"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), ситема изменяет формат введенного значения, выполняется сценарий 3 (см.ниже).
*Негативный сценарий*|
4.3|Оставить поле пустым|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Поле не должно быть пустым".
4.4|Заполнить поле невалидными данными "67"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Неверно указан срок действия карты".
4.5|Заполнить поле не цифровыми значениями(буквы, спец символы)| Система не допускает ввод не цифровых символов в поле.
4.6|Заполнить поле месяцем, который раньше тякущего, если заполнен год равный текущему| При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Истёк срок действия карты".
5.|В открывшейся форме, щелкнуть на поле "Год" (элемент с тегом *input__top="Год"*)|Поле активно для ввода номера года. Бледный текстом номер текущего месяца в формате "ГГ".
*Сценарий тестирования поля "Год"*|
*Позитивный сценарий*|
5.1|Заполнить поле валидными значениями в формате "ГГ", например "22"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными),выполняется сценарий 3 (см.ниже).
*Негативный сценарий*|
5.2|Оставить поле пустым|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Поле не должно быть пустым".
5.3|Заполнить поле невалидными данными-год позже 26го "37"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Неверно указан срок действия карты".
5.4|Заполнить поле невалидными данными-год ранее текущего "19"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Истёк срок действия карты".
5.5|Заполнить поле не цифровыми значениями(буквы, спец символы)| Система не допускает ввод не цифровых символов в поле.
6.|В открывшейся форме, щелкнуть на поле "Владелец" (элемент с тегом *input__top="Владелец"*)|Поле активно для ввода Фамилии и Имени владельца Бледный текстом в формате предусмотренным для ввода ФИ на картах.
*Сценарий тестирования поля "Владелец"*|
*Позитивный сценарий*|
6.1|Заполнить поле валидными значениями в формате предусмотренным для карт, например "IVANOV IVAN"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 3 (см.ниже).
6.2|Заполнить поле валидными значениями в формате предусмотренным для карт, но разными регистрами например "IvaNOV ivAN"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система переводит ФИ в верхний регистр, выполняется сценарий 3 (см.ниже).
6.3|Ввести в поле двойное имя через пробел|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 3 (см.ниже).
6.4|Ввести в поле двойное имя через тире|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 3 (см.ниже).
6.5|Ввести в поле короткое имя и фамилию из одной буквы|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 3 (см.ниже).
6.6|Ввести в поле длинные имя и фамилию|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 3 (см.ниже).
*Негативный сценарий*|
6.7|Оставить поле пустым|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Поле не должно быть пустым".
6.8|Заполнить поле не буквенными значениями, латинской расскладки(цифры, спец символы, буквы расскладки кириллицы)| Система не допускает ввод не латинских символов в поле.
7.|В открывшейся форме, щелкнуть на поле "CVC/CVV" (элемент с тегом *input__top="Владелец"*)|Поле активно для ввода Фамилии и Имени владельца Бледный текстом в формате "ХХХ"
*Сценарий тестирования поля "Владелец"*|
*Позитивный сценарий*|
7.1| Заполнить поле валидными значениями - три цифры "009"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 3 (см.ниже).
*Негативный сценарий*|
7.2|Оставить поле пустым|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Поле не должно быть пустым".
7.3|Заполнить поле не цифровыми значениями(буквы, спец символы| Система не допускает ввод не цифровых символов в поле.
7.4|Заполнить поле цифрами в количестве менее трех|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Неверный формат".
7.5|Заполнить поле цифрами в количестве более трех|Система не допускает ввод в поле более трех цифр.

<details>
  <summary>Подробнее позитивный сценарий</summary>

![шаг1](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_1.png) 

![шаг2](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_2.png)

![шаг3](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_3.png)

</details>

<details>
  <summary>Подробнее негативный сценарий</summary>

![шаг1](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_1.png) 

![шаг2](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_2.png)

![шаг3](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_4.png)

</details>

**Сценарий 2:**
№пп | шаги  |ожидаемый результат
--- | --- | ---
1.| Перейти на [веб-сервис "Путешествие дня"](http://localhost:8080/)| Сайт открывается.
2.|Кликнуть по книпке с текстом "Купить в кредит"| Окрывается форма "Кредит по данным карты" с полями для заполнения данных карты.
3.|Далее шаги 3-7 аналогично сценарию 1. Но при успешных сценариях создается запись в таблицах  "order_entity" и "credit_request_entity". См.Сценарий 3.

<details>
  <summary>Подробнее позитивный сценарий</summary>

![шаг1](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B92_1.png) 

![шаг2](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_2.png)

![шаг3](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_3.png)

</details>

<details>
  <summary>Подробнее негативный сценарий</summary>

![шаг1](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B92_1.png) 

![шаг2](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_2.png)

![шаг3](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_4.png)

</details>

**Сценарий 3.
Подробный позитивный сценарий обработки покупки тура при всех валидных данных):**
№пп | шаги  
--- | --- 
1.| Происходит запрос json через API в банковский сервис для валидных номеров карт:
```
{
    "number": "4444 4444 4444 4441",
    "status": "APPROVED"
  }
```
2.| получении от него json ответа со статусом 200 вида:
```
{
    "id": "09835b78-94c9-42e7-8158-6f49b8820a18",
    "status": "APPROVED"
}
```
3.| Обращение к СУБД и Создание Записи в таблицу "order_entity"
c id (payment_id) и статусом полученными из  json ответа от симулятора
4.|Создание Записи в таблицу "payment_entity" где transaction_id=payment_id из таблицы "order_entity" и значение amount равно сумме покупки тура в копейках(4 500 000)
5.|Система выдает сообщение об успешной операции "Успешно. Операция одобрена банком!" 


## 2. Перечень используемых инструментов с обоснованием выбора
**1. Браузер Google Chrome v.83.0.4103.97**

*Наиболее частоиспользуемый браузер. Множество инструментов для UI тестирования  и разработки.*

**2. OpenJDK 11 (LTS)**

*Актуальная версия. Проект по созданию полностью совместимого Java Development Kit, состоящего исключительно из свободного и открытого исходного кода.*

**3. IntelliJ IDEA 2019.2.4 (Community Edition)**

*Интеллектуальная мощная среда разработки на JAVA и не только, понимающая код. Обращает внимание на существующие ошибки и самостоятельно устраняет их, предоставляет варианты автоматического дополнения кода,избавляет от повседневной рутины и позволяет сконцентрироваться на более важных задачах.*

**4. Библиотека для модульного тестирования Junit-jupiter v.5.6.1**

 *JUnit 5 состоит из JUnit Platform ,JUnit Jupiter, JUnit Vintage(позволяет интегрировать предедущие версии). Предназначена библиотека для модульного тестирования программного обеспечения на языке Java. Это актуальная версия библиотеки тестирования. Принципиальных различий по описанию возможностей от TestNG не найдено.* 

**5. Selenide v.5.12.0.**

*Selenide - удобный инструмент для автоматических тестов, построенный на базе Selenium WebDriver. Он позволяет автоматически управлять браузером (открытие, закрытие).Selenide предлагает лаконичный и мощный API, который поможет писать короткие и хорошо читаемые тесты.Когда тест падает, Selenide автоматически делает скриншот.*

**6. Проект на базе сборки Gradle.** 

*Gradle ряд плюсов. Скрипты сборки Gradle, написанные на Groovy, на порядок короче XML, используемых Maven. Работа с командной строкой быстрее и проще. Проще подключение зависимостей. Gradle быстрее Maven, в нём используются всевозможные кэши и даже специальный процесс – Gradle Daemon, живущий после сборки.*

**7. Docker**


## 3. Перечень и описание возможных рисков при автоматизации
В ситуации если графический интерфейс части сайта, отвечающего за создание заявки, сильно изменится в ближайшем будущем, то возникают большие риски обрушения всех созданных ранее веб-тестов. Следовательно при любых изменениях UI сайта, необходимо актуализировать все автотесты.

## 4. Интервальная оценка с учётом рисков (в часах)


## 5. План сдачи работ (когда будут авто-тесты, результаты их прогона и отчёт по автоматизации)