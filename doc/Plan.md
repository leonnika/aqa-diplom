# План автоматизации тестирования сценария покупки тура через комплексный веб-сервис, взаимодействующего с СУБД и API Банка.

## 1. Перечень автоматизируемых сценариев
***ВАЖНО** Перед началом тестирования сценариев, необходимо правильно запустить SUT. Вся информация о последовательности действий для успешного запуска приведена в файле [README.md](https://github.com/leonnika/aqa-diplom/blob/master/README.md)*

**Сценарий №1. Позитивный сценарий покупки тура по карте.**
1. Открыть сайт [веб-сервис "Путешествие дня"](http://localhost:8080/).
2. Кликнуть по кнопке «Купить».
3. Заполнить поле «Номер карты» валидными данными.
4.Протестировать поле «Номер карты» по сценариям см. Сценарии для тестирования поля «Номер карты» ).
5. Заполнить поле «Месяц» и поле «Год» валидными данными. (валидной считается дата в диапазоне от текущей до плюс пять лет, максимальный срок действия карты).
6.Протестировать поле «Месяц» по сценариям см. Сценарии для тестирования поле «Месяц» ).
7. Протестировать поле «Год» по сценариям см. Сценарии для тестирования поле «Год» ).
8. Заполнить поле «Владелец» валидными данными.
9. Протестировать поле «Владелец» по сценариям см. Сценарии для тестирования поля «Владелец» ).
10. Заполнить поле «CVC/CVV» валидными данными.
11. Протестировать поле «CVC/CVV» по сценариям см. Сценарии для тестирования поля «CVC/CVV» ).
12. Нажать кнопку «Продолжить».
13. Отправить JSON запрос с данной картой и получить статус  транзакциииз ответа от симулятора.
14. Проверить создание записи в БД в таблицу "order_entity" и получить из нее код payment_id, выборка записи с самой поздней датой и времени создания.
15. Проверить создание записи в БД в таблицу "payment_entity". Выборка записи с самой поздней датой и времени создания. Проверка значений полей transaction_id= payment_id(из таблицы "order_entity"), status равен статусу транзакции из ответа от симулятора, amount равно сумме покупки тура в копейках(4 500 000), полученного со стартовой страницы сервиса.
16. Проверить вывод сообщения от сервиса пользователю об успешно выполненной операции, при статусе транзакции = APPROVED или выводе сообщения об отказе в выполнении операции банком, при при статусе транзакции = DECLINED.

<details>
  <summary>Подробнее позитивный сценарий по карте</summary>

![шаг1](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_1.png) 

![шаг2](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_2.png)

![шаг3](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_3.png)

</details>

<details>
  <summary>Подробнее негативный сценарий покупки по карте</summary>

![шаг1](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_1.png) 

![шаг2](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_2.png)

![шаг3](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_4.png)

</details>

**Сценарий №2. Позитивный сценарий покупки тура по карте в кредит.**
1. Открыть сайт [веб-сервис "Путешествие дня"](http://localhost:8080/).
2. Кликнуть по кнопке «Купить в кредит»
3. Заполнить поле «Номер карты» валидными данными.
4.Протестировать поле «Номер карты» по сценариям см. Сценарии для тестирования поля «Номер карты» ).
5. Заполнить поле «Месяц» и поле «Год» валидными данными. (валидной считается дата в диапазоне от текущей до плюс пять лет, максимальный срок действия карты).
6.Протестировать поле «Месяц» по сценариям см. Сценарии для тестирования поле «Месяц» ).
7. Протестировать поле «Год» по сценариям см. Сценарии для тестирования поле «Год» ).
8. Заполнить поле «Владелец» валидными данными.
9. Протестировать поле «Владелец» по сценариям см. Сценарии для тестирования поля «Владелец» ).
10. Заполнить поле «CVC/CVV» валидными данными.
11. Протестировать поле «CVC/CVV» по сценариям см. Сценарии для тестирования поля «CVC/CVV» ).
12. Нажать кнопку «Продолжить».
13. Отправить JSON запрос с данной картой и получить статус транзакции из ответа от симулятора.
14. Проверить создание записи в БД в таблицу "order_entity" и получить из нее код credit_id, выборка записи с самой поздней датой и времени создания.
15. Проверить создание записи в БД в таблицу "credit_request_entity". Выборка записи с самой поздней датой и времени создания. Проверка значений полей bank_id= credit_id(из таблицы "order_entity"), status равен статусу транзакции из ответа от симулятора.
16. Проверить вывод сообщения от сервиса пользователю об успешно выполненной операции, при статусе транзакции = APPROVED или выводе сообщения об отказе в выполнении операции банком, при при статусе транзакции = DECLINED.

<details>
  <summary>Подробнее позитивный сценарий покупки в кредит</summary>

![шаг1](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B92_1.png) 

![шаг2](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_2.png)

![шаг3](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_3.png)

</details>

<details>
  <summary>Подробнее негативный сценарий покупки в кредит</summary>

![шаг1](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B92_1.png) 

![шаг2](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_2.png)

![шаг3](https://github.com/leonnika/aqa-diplom/blob/master/png/plan/%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B91_4.png)

</details>

## Подробные сценарии тестирования всех полей формы.
<details>
  <summary>Сценарий для тестирования поля «Номер карты»</summary>

№пп | шаги  |ожидаемый результат
--- | --- | ---
*Позитивный сценарий*|
1.|Ввести в поле валидное значение| При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 1.
*Негативный сценарий*|
1.|Оставить поле пустым|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Поле не должно быть пустым".
2.|Заполнить поле цифрами в количестве меньше 16|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Неверный формат".
3.|Заполнить поле "0000 0000 0000 0000"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Неверный формат".
4.|Заполнить поле не цифровыми значениями(буквы, спец символы)| Система не допускает ввод не цифровых символов в поле.
5.|Заполнить поле невалидным номером карты, например "4444 4444 4444 4444"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), происходит запрос в банковский сервис и при получении от него ответа, система выдает сообщение об ошибки "Банк отказал в проведении операции". Запись в БД не происходит.
</details>

<details>
  <summary>Сценарий для тестирования поля «Месяц»</summary>

№пп | шаги  |ожидаемый результат
--- | --- | ---
1.|В открывшейся форме, щелкнуть на поле "Месяц" |Поле активно для ввода номера месяца. Бледный текстом номер текущего месяца в формате "ММ".
*Сценарий тестирования поля "Месяц"*|
*Позитивный сценарий*|
2.|Заполнить поле валидными значениями в формате "ММ", например "01" или "12"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 1.
3.|Заполнить поле валидными значениями в формате "М", например "1"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), ситема изменяет формат введенного значения, выполняется сценарий 3 (см.ниже).
*Негативный сценарий*|
4.|Оставить поле пустым|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Поле не должно быть пустым".
5.|Заполнить поле невалидными данными "67"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Неверно указан срок действия карты".
6.|Заполнить поле не цифровыми значениями(буквы, спец символы)| Система не допускает ввод не цифровых символов в поле.
7.|Заполнить поле месяцем, который раньше тякущего, если заполнен год равный текущему| При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Истёк срок действия карты".
</details>

<details>
  <summary>Сценарий для тестирования поля «Год»</summary>

№пп | шаги  |ожидаемый результат
--- | --- | ---
1.|В открывшейся форме, щелкнуть на поле "Год" |Поле активно для ввода номера года. Бледный текстом номер текущего месяца в формате "ГГ".
*Сценарий тестирования поля "Год"*|
*Позитивный сценарий*|
2.|Заполнить поле валидными значениями в формате "ГГ", например "22"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 1.
*Негативный сценарий*|
3.|Оставить поле пустым|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Поле не должно быть пустым".
4.|Заполнить поле невалидными данными-год позже 26го "37"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Неверно указан срок действия карты".
5.|Заполнить поле невалидными данными-год ранее текущего "19"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Истёк срок действия карты".
6.|Заполнить поле не цифровыми значениями(буквы, спец символы)| Система не допускает ввод не цифровых символов в поле.
</details>

<details>
  <summary>Сценарий для тестирования поля «Владелец»</summary>

№пп | шаги  |ожидаемый результат
--- | --- | ---
1.|В открывшейся форме, щелкнуть на поле "Владелец" |Поле активно для ввода Фамилии и Имени владельца Бледный текстом в формате предусмотренным для ввода ФИ на картах.
*Сценарий тестирования поля "Владелец"*|
*Позитивный сценарий*|
2.|Заполнить поле валидными значениями в формате предусмотренным для карт, например "IVANOV IVAN"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 1.
3.|Заполнить поле валидными значениями в формате предусмотренным для карт, но разными регистрами например "IvaNOV ivAN"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система переводит ФИ в верхний регистр, выполняется сценарий 1.
4.|Ввести в поле двойное имя через пробел|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 1.
5.|Ввести в поле двойное имя через тире|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 1.
6.|Ввести в поле короткое имя и фамилию из одной буквы|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 1.
7.|Ввести в поле длинные имя и фамилию|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 1.
*Негативный сценарий*|
8.|Оставить поле пустым|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Поле не должно быть пустым".
9.|Заполнить поле не буквенными значениями, латинской расскладки(цифры, спец символы, буквы расскладки кириллицы)| Система не допускает ввод не латинских символов в поле.
</details>

<details>
  <summary>Сценарий для тестирования поля «CVC/CVV»</summary>

№пп | шаги  |ожидаемый результат
--- | --- | ---
1.|В открывшейся форме, щелкнуть на поле "CVC/CVV"|Поле активно для ввода Фамилии и Имени владельца Бледный текстом в формате "ХХХ"
*Сценарий тестирования поля "Владелец"*|
*Позитивный сценарий*|
2.| Заполнить поле валидными значениями - три цифры "009"|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), выполняется сценарий 3 (см.ниже).
*Негативный сценарий*|
3.|Оставить поле пустым|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Поле не должно быть пустым".
4.|Заполнить поле не цифровыми значениями(буквы, спец символы| Система не допускает ввод не цифровых символов в поле.
5.|Заполнить поле цифрами в количестве менее трех|При нажатие на кнопку с текстом "Продолжить"(при заполненных всех других полей валидными данными), система выдает сообщение об ошибки "Неверный формат".
6.|Заполнить поле цифрами в количестве более трех|Система не допускает ввод в поле более трех цифр.
</details>


## 2. Перечень используемых инструментов с обоснованием выбора
**1. Браузер Google Chrome v.83.0.4103.97**

*Наиболее частоиспользуемый браузер. Множество инструментов для UI тестирования  и разработки.*

**2. OpenJDK 11 (LTS)**

*Актуальная версия. Проект по созданию полностью совместимого Java Development Kit, состоящего исключительно из свободного и открытого исходного кода.*

**3. IntelliJ IDEA 2019.2.4 (Community Edition)**

*Интеллектуальная мощная среда разработки на JAVA и не только, понимающая код. Обращает внимание на существующие ошибки и самостоятельно устраняет их, предоставляет варианты автоматического дополнения кода,избавляет от повседневной рутины и позволяет сконцентрироваться на более важных задачах.*

**4. Библиотека для модульного тестирования Junit-jupiter v.5.6.1**

 *JUnit 5 состоит из JUnit Platform ,JUnit Jupiter, JUnit Vintage(позволяет интегрировать предедущие версии). Предназначена библиотека для модульного тестирования программного обеспечения на языке Java. Это актуальная версия библиотеки тестирования. Принципиальных различий по описанию возможностей от TestNG не найдено.* 

**5. Selenide v.5.12.0.**

*Selenide - удобный инструмент для автоматических тестов, построенный на базе Selenium WebDriver. Он позволяет автоматически управлять браузером (открытие, закрытие).Selenide предлагает лаконичный и мощный API, который поможет писать короткие и хорошо читаемые тесты.Когда тест падает, Selenide автоматически делает скриншот.*

**6. Проект на базе сборки Gradle.** 

*Gradle ряд плюсов. Скрипты сборки Gradle, написанные на Groovy, на порядок короче XML, используемых Maven. Работа с командной строкой быстрее и проще. Проще подключение зависимостей. Gradle быстрее Maven, в нём используются всевозможные кэши и даже специальный процесс – Gradle Daemon, живущий после сборки.*

**7. Docker**

*Возможности этого программное обеспечение для автоматизации развёртывания и управления приложениями в средах с поддержкой контейнеризации:*

*1. Изоляция запущенных приложений. Можно отделить ваше приложение от ОС хоста и обращаться с ним как с управляемым приложением.*

*2. Облегчение процесса разработки, тестирования и развертывания приложений.*

*3. Нет необходимости в конфигурации среды для запуска – она поставляется вместе с приложением.*



## 3. Перечень и описание возможных рисков при автоматизации
В ситуации если графический интерфейс части сайта, отвечающего за создание заявки, сильно изменится в ближайшем будущем, то возникают большие риски обрушения всех созданных ранее веб-тестов. Следовательно при любых изменениях UI сайта, необходимо актуализировать все автотесты.

## 4. Интервальная оценка с учётом рисков 
№пп | Этап  |Интервальная оценка(час)
--- | --- | ---
1.|Авто-тесты, результаты их прогона| 15
2.|Отчётные документы по итогам тестирования| 1
3.|Отчётные документы по итогам автоматизации|3

## 5. План сдачи работ 
№пп | Этап  |Дата сдачи
--- | --- | ---
1.|Авто-тесты, результаты их прогона| 27.07.2020
2.|Отчётные документы по итогам тестирования| 30.07.2020
3.|Отчётные документы по итогам автоматизации|03.08.2020